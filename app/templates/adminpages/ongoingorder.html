<!doctype html>
{% load static %}
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Cafe - On Going Order</title>
    <meta name="description" content="Sufee Admin - HTML5 Admin Template">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="apple-touch-icon" href="{% static 'adminpages/apple-icon.png' %}">
    <link rel="shortcut icon" type="image/x-icon" href="{% static 'img/orange logo.jpg' %}">


    <link rel="stylesheet" href="{% static 'adminpages/vendors/bootstrap/dist/css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'adminpages/vendors/font-awesome/css/font-awesome.min.css' %}">
    <link rel="stylesheet" href="{% static 'adminpages/vendors/themify-icons/css/themify-icons.css' %}">
    <link rel="stylesheet" href="{% static 'adminpages/vendors/flag-icon-css/css/flag-icon.min.css' %}">
    <link rel="stylesheet" href="{% static 'adminpages/vendors/selectFX/css/cs-skin-elastic.css' %}">
    <link rel="stylesheet" href="{% static 'adminpages/vendors/datatables.net-bs4/css/dataTables.bootstrap4.min.css' %}">
    <link rel="stylesheet" href="{% static 'adminpages/vendors/datatables.net-buttons-bs4/css/buttons.bootstrap4.min.css' %}">

    <link rel="stylesheet" href="{% static 'adminpages/assets/css/style.css' %}">
    <link rel="stylesheet" href="{% static 'w3.css' %}">

    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800' rel='stylesheet' type='text/css'>
    <link rel="apple-touch-icon" href="{% static 'adminpages/apple-icon.png' %}">

    <link rel="stylesheet" href="{% static 'adminpages/vendors/chosen/chosen.min.css' %}">
<style type="text/css">
        input[type=checkbox]:checked + div {
           border: 2px solid red;
           border-radius:10px;
           box-shadow:2px 2px 5px;
         }
</style>
</head>

<body>
    <!-- Left Panel -->

    <aside id="left-panel" class="left-panel">
        <nav class="navbar navbar-expand-sm navbar-default">

            <div class="navbar-header">
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-menu" aria-controls="main-menu" aria-expanded="false" aria-label="Toggle navigation">
                    <i class="fa fa-bars"></i>
                </button>
                <a class="navbar-brand" href="./"><img style="width:75px;border-radius:10px;"src="{% static 'img/orange logo.jpg' %}" alt="Logo" style="width:100px;"></a>
                <a class="navbar-brand hidden" href="./"><img style="width:75px;border-radius:10px;"src="{% static 'img/orange logo.jpg' %}" alt="Logo"></a>
            </div>

            <div id="main-menu" class="main-menu collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li class="active">
                        <a href="/adminindex/"> <i class="menu-icon fa fa-dashboard"></i>Dashboard </a>
                    </li>
                    <!-- /.menu-title -->
                    <li class="menu-item-has-children dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="menu-icon fa fa-shopping-cart"></i>Menu</a>
                        <ul class="sub-menu children dropdown-menu">
                            <li><i class="fa fa-building"></i><a href="/adminaddmenucategory/">Add Menu Category</a></li>
                            <li><i class="fa fa-building"></i><a href="/adminaddmenuitem/">Add Menu Items</a></li>
                        </ul>
                    </li>
                    <li class="menu-item-has-children dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="menu-icon fa fa-shopping-cart"></i>Discount Desk</a>
                        <ul class="sub-menu children dropdown-menu">
                            <li><i class="fa fa-building"></i><a href="/admincoincount/">Coins Count</a></li>
                            <li><i class="fa fa-building"></i><a href="/adminitemdiscount/">Item Discount</a></li>
                            <li><i class="fa fa-building"></i><a href="/adminadddiscountcoupon/">Add Discount Coupon</a></li>
                            <li><i class="fa fa-building"></i><a href="/admindiscountcouponlist/">Discount Coupon List</a></li>
                        </ul>
                    </li>
                    <li class="menu-item-has-children dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="menu-icon fa fa-shopping-cart"></i>Order Desk</a>
                        <ul class="sub-menu children dropdown-menu">
                            <li><i class="fa fa-building"></i><a href="/adminongoingorder/">On Going Orders</a></li>
                            <li><i class="fa fa-building"></i><a href="/adminorderhistory/">Order History</a></li>
                            <li><i class="fa fa-building"></i><a href="/adminpaymenthistory/">Payment History</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="/admincustomerlist/"><i class="menu-icon fa fa-dashboard"></i>Customers List</a>
                    </li>
                    <li class="menu-item-has-children dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="menu-icon fa fa-shopping-cart"></i>Settings</a>
                        <ul class="sub-menu children dropdown-menu">
                            <li><i class="fa fa-building"></i><a href="/adminchangemanager/">Manage Password</a></li>
                            <li><i class="fa fa-building"></i><a href="/admintax/">Tax Management</a></li>
                        </ul>
                    </li>
                </ul>
            </div><!-- /.navbar-collapse -->
        </nav>
    </aside>

    <!-- Left Panel -->

    <!-- Right Panel -->

    <div id="right-panel" class="right-panel">

        <!-- Header-->
        <header id="header" class="header">

            <div class="header-menu">

                <div class="col-sm-7">
                    <a id="menuToggle" class="menutoggle pull-left"><i class="fa fa fa-tasks"></i></a>
                </div>

                <div class="header-menu">
                    <a href="/adminlogout/" style="float:right;">Logout</a>
                </div>
                
            </div>

        </header><!-- /header -->
        <!-- Header-->

        <div class="breadcrumbs">
            <div class="col-sm-4">
                <div class="page-header float-left">
                    <div class="page-title">
                    </div>
                </div>
            </div>
            <div class="col-sm-8">
                <div class="page-header float-right">
                    <div class="page-title">
                        <ol class="breadcrumb text-right">
                            <li><a href="/adminindex/">Dashboard</a></li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>

        <div class="content mt-3">
            <div class="animated fadeIn">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">
                                <strong class="card-title">Create New Order</strong>
                            </div>
                            <div class="card-body">
                                <h2 style="margin-bottom:10px;">Select Menu Item To Create Order</h2>
                                <form action="/admincreateorder/" method="POST">
                                    {% for x in category %}
                                    <div class="card-header">
                                        <a style="color:black;font-size:20px;font-weight:bold;"href="#" onclick="document.getElementById('cat{{ x.Category_Name|safe }}').style.display='block';{% for a in category %}{% if not a.Category_Name == x.Category_Name %}document.getElementById('cat{{ a.Category_Name|safe }}').style.display='none';{% endif %}{% endfor %}">{{ x.Category_Name|safe }}</a>
                                    </div>
                                    <br>
                                    <div class="w3-animate-top" id="cat{{ x.Category_Name|safe }}"style="display:none;">
                                    {% for y in items %}
                                    {% if x.Category_ID == y.Item_Category %}
                                    
                                    <label>
                                        <input type="checkbox" name="{{ y.Item_ID|safe }}" style="position:absolute;opacity:0;height:0;width:0;cursor:pointer;" value="{{ y.Item_ID|safe }}" onclick="document.getElementById('createbutton').disabled=false;">
                                        <div style="background-size:100% auto;background-image:url({{ y.Item_Thumb.url|safe }});font-weight:bold;padding:20px;margin:5px;font-size:18px;border-radius:10px;"class="w3-card">{{ y.Item_Name|safe }}</div>
                                    </label>
                                    
                                    {% endif %}
                                    {% endfor %}
                                    </div>
                                    {% endfor %}
                                    <div class="form-group" style="padding-top:10px;">
                                        <button type="submit" disabled class="btn btn-success" id="createbutton" onclick="document.getElementById('process').style.display='block';document.getElementById('msg').style.display='none';">Proceed</button><br>
                                        <label id="process" style="display:none;color:green;font-weight:bold;">Processing Please Wait...</label>
                                        <label id="msg" style="color:green;font-weight:bold;">{{ msg|safe }}</label>
                                    </div>
                                </form>
                            </div>
                        </div>
                        


                        <div class="card">
                            <div class="card-header">
                                <strong class="card-title">On Going Order</strong>
                            </div>
                            <div class="card-body">
                                <table id="bootstrap-data-table-export" class="table table-striped table-bordered">
                                    <thead>
                                        <tr>
                                            <th>Date & Time</th>
                                            <th>Order ID</th>
                                            <th>Table No.</th>
                                            <th>Customer ID</th>
                                            <th>Menu Detail</th>
                                            <th>Pay Now</th>
                                            <th>Cancel</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for x in orderdata %}
                                        <tr>
                                            <td>{{ x.Add_Date.date|safe }}</td>
                                            <td>{{ x.Order_ID|safe }}</td>
                                            <td>{% if x.Table_No == 'Not Assigned' %}<button class="btn btn-primary"type="button" data-toggle="modal" data-target="#{{ x.Order_ID|safe }}smallmodal">Assign Table</button>{% else %}{{ x.Table_No|safe }}<button style="border:none;cursor:pointer;"data-toggle="modal" data-target="#{{ x.Order_ID|safe }}smallmodal"><i class="fa fa-pencil"></i></button>{% endif %}</td>
                                            <td>{{ x.Customer_ID|safe }}</td>
                                            <td><a href="" data-toggle="modal" data-target="#{{ x.Order_ID|safe }}mediumModal" class="btn btn-primary">View Menu</a></td>
                                            <td><a href="/adminsearchcustomer/?orderid={{ x.Order_ID|safe }}" class="btn btn-success">Pay</a></td>
                                            <td><a href="/admincancelorder/?orderid={{ x.Order_ID|safe }}" class="btn btn-danger">Cancel</a></td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                </div>
            </div><!-- .animated -->
        </div><!-- .content -->


    </div><!-- /#right-panel -->
    {% for x in orderdata %}
                    <div class="modal fade" id="{{ x.Order_ID|safe }}mediumModal" tabindex="-1" role="dialog" aria-labelledby="mediumModalLabel" aria-hidden="true" style="z-index:50000;">
                            <div class="modal-dialog modal-lg" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="mediumModalLabel"><span style="font-weight:bold;">{{ x.Order_ID|safe }}</span> Order Menu Detail</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body" style="overflow-y:auto;height:376px;">
                                        <div class="row form-group">
                                            <div class="col col-md-12">
                                                <form action="/adminaddmoreitemstoorder/" method="POST">
                                                <div class="input-group" style="width:90%;float:left;">
                                                    <select data-placeholder="Add More Menu Items Here" multiple id="input2-group2" class="form-control standardSelect" name="items" tabindex="5">
                                                        <option value=""></option>
                                                        {% for y in category %}
                                                            <optgroup label="{{ y.Category_Name }}">
                                                              {% for q in items %}
                                                                {% if q.Item_Category == y.Category_ID %}
                                                                    <option value="{{ q.Item_ID|safe }}">{{ q.Item_Name|safe }}</option>
                                                                {% endif %}
                                                            {% endfor %}
                                                            </optgroup>    
                                                        {% endfor %}
                                                    </select>
                                                </div>
                                                <div class="input-group-btn" style="float:left;width:10%;">
                                                    <input type="hidden" value="{{ x.Order_ID|safe }}" name="orderid">
                                                    <input type="submit" style="width:100%;height:30px;text-align:center;padding:2px;" class="btn btn-primary" value="Add">
                                                </div>
                                                </form>
                                            </div>
                                        </div>
                                        <form action="/adminsaveordermenu/" method="POST">
                                        <table class="table table-striped">
                                            <thead>
                                                <tr>
                                                    <th scope="col">Item</th>
                                                    <th scope="col">Category</th>
                                                    <th scope="col">Quantity</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% for w in ordermenudata %}
                                                {% if x.Order_ID == w.Order_ID %}
                                                <tr>
                                                    {% for y in items %}
                                                    {% if w.Item_ID == y.Item_ID %}
                                                    <th scope="row">{{ y.Item_Name }}</th>
                                                    <td>
                                                        {% for z in category %}
                                                        {% if y.Item_Category == z.Category_ID %}
                                                        {{ z.Category_Name|safe }}
                                                        {% endif %}
                                                        {% endfor %}
                                                    </td>
                                                    <td>
                                                        <button type="button" class="btn btn-danger btn-sm" style="float:left;" onclick="subquantity({{ w.Item_ID|safe }}{{ x.Order_ID|safe }}quantity);"><i class="fa fa-minus"></i></button>
                                                        <input type="number" value="{{ w.Quantity|safe }}" id="{{ w.Item_ID|safe }}{{ x.Order_ID|safe }}quantity" style="width:50px;float:left;height:30px;text-align:center;" name="{{ w.Item_ID|safe }}{{ x.Order_ID|safe }}" class="form-control">
                                                        <button type="button" class="btn btn-success btn-sm" style="float:left;" onclick="addquantity({{ w.Item_ID|safe }}{{ x.Order_ID|safe }}quantity);"><i class="fa fa-plus"></i></button>
                                                    </td>
                                                    {% endif %}
                                                    {% endfor %}
                                                </tr>
                                                {% endif %}
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Back</button>
                                        <input type="hidden" value="{{ x.Order_ID|safe }}" name="orderid">
                                        <button type="submit" class="btn btn-primary">Apply Changes</button>
                                    </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
    <!-- Right Panel -->
    {% for x in orderdata %}
    <div class="modal fade" id="{{ x.Order_ID|safe }}smallmodal" tabindex="-1" role="dialog" aria-labelledby="smallmodalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-sm" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="smallmodalLabel">Assign Table to Order {{ x.Order_ID|safe }}</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <form action="/adminsettable/" method="POST">
                                    <div class="form-group">
                                        <label for="company" class=" form-control-label">Enter Table No.</label>
                                        <input type="hidden" value="{{ x.Order_ID|safe }}" name="orderid"s>
                                        {% if x.Table_No == 'Not Assigned' %}
                                        <input type="text" placeholder="Enter Here" name="table" class="form-control">
                                        {% else %}
                                        <input type="text" value="{{ x.Table_No|safe }}" name="table" class="form-control">
                                        {% endif %}
                                    </div>
                                    <div class="form-group">
                                        <label id="process" style="display:none;color:green;font-weight:bold;">Processing Please Wait...</label>
                                        <label id="msg" style="color:green;font-weight:bold;">{{ msg|safe }}</label>
                                    </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                <button type="submit" class="btn btn-primary" onclick="document.getElementById('process').style.display='block';document.getElementById('msg').style.display='none';">Save</button>
                            </div>
                            </form>
                        </div>
                    </div>
                </div>
                {% endfor %}
    <script src="{% static 'adminpages/vendors/jquery/dist/jquery.min.js' %}"></script>
    <script src="{% static 'adminpages/vendors/popper.js/dist/umd/popper.min.js' %}"></script>
    <script src="{% static 'adminpages/vendors/bootstrap/dist/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'adminpages/assets/js/main.js' %}"></script>


    <script src="{% static 'adminpages/vendors/datatables.net/js/jquery.dataTables.min.js' %}"></script>
    <script src="{% static 'adminpages/vendors/datatables.net-bs4/js/dataTables.bootstrap4.min.js' %}"></script>
    <script src="{% static 'adminpages/vendors/datatables.net-buttons/js/dataTables.buttons.min.js' %}"></script>
    <script src="{% static 'adminpages/vendors/datatables.net-buttons-bs4/js/buttons.bootstrap4.min.js' %}"></script>
    <script src="{% static 'adminpages/vendors/pdfmake/build/vfs_fonts.js' %}"></script>
    <script src="{% static 'adminpages/vendors/datatables.net-buttons/js/buttons.html5.min.js' %}"></script>
    <script src="{% static 'adminpages/vendors/datatables.net-buttons/js/buttons.print.min.js' %}"></script>
    <script src="{% static 'adminpages/vendors/datatables.net-buttons/js/buttons.colVis.min.js' %}"></script>
    <script src="{% static 'adminpages/assets/js/init-scripts/data-table/datatables-init.js' %}"></script>
<script src="{% static 'adminpages/vendors/chosen/chosen.jquery.min.js' %}"></script>

<script>
    jQuery(document).ready(function() {
        jQuery(".standardSelect").chosen({
            disable_search_threshold: 10,
            no_results_text: "Oops, nothing found!",
            width: "100%"
        });
    });
</script>
<script type="text/javascript">
    function addquantity(idd){
        var quantity = parseInt(idd.value, 10);
        var newquantity = quantity + 1;
        idd.value = newquantity;
    }
    function subquantity(idd){
        var quantity = parseInt(idd.value, 10);
        var newquantity = quantity - 1;
        if (newquantity < 0){
            idd.value = 0;    
        }
        else{
            idd.value = newquantity;
        }
    }
</script>
</body>

</html>
