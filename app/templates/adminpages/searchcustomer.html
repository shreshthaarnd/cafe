<!doctype html>
{% load static %}
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Cafe - Search Customer & Pay</title>
    <meta name="description" content="Sufee Admin - HTML5 Admin Template">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="apple-touch-icon" href="{% static 'adminpages/apple-icon.png' %}">
    <link rel="shortcut icon" type="image/x-icon" href="{% static 'img/orange logo.jpg' %}">


    <link rel="stylesheet" href="{% static 'adminpages/vendors/bootstrap/dist/css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'adminpages/vendors/font-awesome/css/font-awesome.min.css' %}">
    <link rel="stylesheet" href="{% static 'adminpages/vendors/themify-icons/css/themify-icons.css' %}">
    <link rel="stylesheet" href="{% static 'adminpages/vendors/flag-icon-css/css/flag-icon.min.css' %}">
    <link rel="stylesheet" href="{% static 'adminpages/vendors/selectFX/css/cs-skin-elastic.css' %}">
    <link rel="stylesheet" href="{% static 'adminpages/vendors/datatables.net-bs4/css/dataTables.bootstrap4.min.css' %}">
    <link rel="stylesheet" href="{% static 'adminpages/vendors/datatables.net-buttons-bs4/css/buttons.bootstrap4.min.css' %}">

    <link rel="stylesheet" href="{% static 'adminpages/assets/css/style.css' %}">

    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800' rel='stylesheet' type='text/css'>
    <link rel="apple-touch-icon" href="{% static 'adminpages/apple-icon.png' %}">

    <link rel="stylesheet" href="{% static 'adminpages/vendors/chosen/chosen.min.css' %}">

</head>

<body>
    <!-- Left Panel -->

    <aside id="left-panel" class="left-panel">
        <nav class="navbar navbar-expand-sm navbar-default">

            <div class="navbar-header">
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-menu" aria-controls="main-menu" aria-expanded="false" aria-label="Toggle navigation">
                    <i class="fa fa-bars"></i>
                </button>
                <a class="navbar-brand" href="./"><img style="width:75px;border-radius:10px;"src="{% static 'img/orange logo.jpg' %}" alt="Logo" style="width:100px;"></a>
                <a class="navbar-brand hidden" href="./"><img style="width:75pxborder-radius:10px;;"src="{% static 'img/orange logo.jpg' %}" alt="Logo"></a>
            </div>

            <div id="main-menu" class="main-menu collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li class="active">
                        <a href="/adminindex/"> <i class="menu-icon fa fa-dashboard"></i>Dashboard </a>
                    </li>
                    <!-- /.menu-title -->
                    {% if checklogin == 'admin' %}
                    <li class="menu-item-has-children dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="menu-icon fa fa-shopping-cart"></i>Menu</a>
                        <ul class="sub-menu children dropdown-menu">
                            <li><i class="fa fa-building"></i><a href="/adminaddmenucategory/">Add Menu Category</a></li>
                            <li><i class="fa fa-building"></i><a href="/adminaddmenuitem/">Add Menu Items</a></li>
                        </ul>
                    </li>
                    <li class="menu-item-has-children dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="menu-icon fa fa-shopping-cart"></i>Discount Desk</a>
                        <ul class="sub-menu children dropdown-menu">
                            <li><i class="fa fa-building"></i><a href="/admincoincount/">Coins Count</a></li>
                            <li><i class="fa fa-building"></i><a href="/adminadddiscountcoupon/">Add Discount Coupon</a></li>
                            <li><i class="fa fa-building"></i><a href="/admindiscountcouponlist/">Discount Coupon List</a></li>
                        </ul>
                    </li>
                    {% endif %}
                    <li class="menu-item-has-children dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="menu-icon fa fa-shopping-cart"></i>Order Desk</a>
                        <ul class="sub-menu children dropdown-menu">
                            <li><i class="fa fa-building"></i><a href="/adminongoingorder/">On Going Orders</a></li>
                            <li><i class="fa fa-building"></i><a href="/adminorderhistory/">Order History</a></li>
                            <li><i class="fa fa-building"></i><a href="/adminpaymenthistory/">Payment History</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="/admincustomerlist/"><i class="menu-icon fa fa-dashboard"></i>Customers List</a>
                    </li>
                    {% if checklogin == 'admin' %}
                    <li class="menu-item-has-children dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="menu-icon fa fa-shopping-cart"></i>Settings</a>
                        <ul class="sub-menu children dropdown-menu">
                            <li><i class="fa fa-building"></i><a href="/adminchangeadmin/">Admin Password</a></li>
                            <li><i class="fa fa-building"></i><a href="/adminchangemanager/">Manager Password</a></li>
                            <li><i class="fa fa-building"></i><a href="/admintax/">Tax Management</a></li>
                        </ul>
                    </li>
                    {% endif %}
                </ul>
            </div><!-- /.navbar-collapse -->
        </nav>
    </aside><!-- /#left-panel -->

    <!-- Right Panel -->

    <div id="right-panel" class="right-panel">

        <!-- Header-->
        <header id="header" class="header">

            <div class="header-menu">

                <div class="col-sm-7">
                    <a id="menuToggle" class="menutoggle pull-left"><i class="fa fa fa-tasks"></i></a>
                </div>

                <div class="header-menu">
                    <a href="/adminlogout/" style="float:right;">Logout</a>
                </div>
                
            </div>

        </header><!-- /header -->
        <!-- Header-->

        <div class="breadcrumbs">
            <div class="col-sm-4">
                <div class="page-header float-left">
                    <div class="page-title">
                    </div>
                </div>
            </div>
            <div class="col-sm-8">
                <div class="page-header float-right">
                    <div class="page-title">
                        <ol class="breadcrumb text-right">
                            <li><a href="/adminindex/">Dashboard</a></li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>

        <div class="content mt-3">
            <div class="animated fadeIn">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">
                                <strong class="card-title">Create New Order</strong>
                            </div>
                            <div class="card-body">
                                <form action="/admincustomersearchresult/" method="GET" id="customersearch">
                                    <label style="font-weight:bold;">Enter Customer Mobile Number and Press Enter</label>
                                    <div class="form-group">
                                        <input type="text" onchange="searchcustomer()" placeholder="Enter Customer's Mobile Number" name="cmobile" class="form-control">
                                    </div>
                                    <div class="form-group" style="padding-top:10px;">
                                        <label id="process" style="display:none;color:green;font-weight:bold;">Processing Please Wait...</label>
                                        <label id="msg" style="color:green;font-weight:bold;">{{ msg|safe }}</label>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                    </div>
                    
                </div>
                <div style="width:400px;margin:auto;"class="card">
                    <div class="card-header">
                        <strong class="card-title">Proceed to pay</strong>
                    </div>
                    <div class="card-body">
                    <!-- Credit Card -->
                        <div id="pay-invoice">
                            <div class="card-body">
                                <div class="card-title">
                                    <h3 class="text-center">Pay Invoice <span style="font-weight:bold;">{{ orderid|safe }}</span></h3>
                                </div>
                                <hr>
                                <form action="/admincompletepayment/" method="POST">
                                    <div class="form-group text-center">
                                        <ul class="list-inline">
                                            <li class="list-inline-item"><i class="text-muted fa fa-cc-visa fa-2x"></i></li>
                                            <li class="list-inline-item"><i class="fa fa-cc-mastercard fa-2x"></i></li>
                                            <li class="list-inline-item"><i class="fa fa-cc-amex fa-2x"></i></li>
                                            <li class="list-inline-item"><i class="fa fa-cc-discover fa-2x"></i></li>
                                        </ul>
                                    </div>
                                    <div class="form-group">
                                        <label for="cc-payment" class="control-label mb-1">Payment amount</label>
                                        <input id="amounttopay" name="finalamount" type="text" class="form-control" value="{{ taxamount|safe }}0">
                                        <input id="cc-pament" name="amount" type="hidden" class="form-control" value="{{ totalamount|safe }}.00">
                                    </div>
                                    {% if result %}
                                    {% for x in result %}
                                    <div class="form-group has-success">
                                        <label for="cc-name" class="control-label mb-1">Customer Name *</label>
                                        <input id="cc-name" name="name" type="text" class="form-control" value="{{ x.Name|safe }}">
                                    </div>
                                    <div class="form-group has-success">
                                        <label for="cc-name" class="control-label mb-1">Mobile Number *</label>
                                        <input id="cc-name" name="mobile" type="text" class="form-control" value="{{ x.Mobile|safe }}">
                                    </div>
                                    <div class="form-group has-success">
                                        <label for="cc-name" class="control-label mb-1">Email Address *</label>
                                        <input id="cc-name" name="email" type="text" class="form-control" value="{{ x.Email|safe }}">
                                    </div>
                                    <div class="form-group has-success">
                                        <label for="cc-name" class="control-label mb-1">Address</label>
                                        <input id="cc-name" name="address" type="text" class="form-control" value="{{ x.Address|safe }}">
                                    </div>
                                    <div class="row">
                                        <div class="col-6">
                                            <div class="form-group">
                                                <label for="cc-exp" class="control-label mb-1">State</label>
                                                <input id="cc-exp" name="state" type="tel" class="form-control" value="{{ x.State|safe }}">
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <label for="x_card_code" class="control-label mb-1">City</label>
                                            <div class="input-group">
                                                <input id="x_card_code" name="city" type="text" class="form-control" value="{{ x.City|safe }}">
                                            </div>
                                        </div>
                                        {% endfor %}
                                        {% else %}
                                    <div class="form-group has-success">
                                        <label for="cc-name" class="control-label mb-1">Customer Name *</label>
                                        <input id="cc-name" name="name" type="text" class="form-control" value="" required>
                                    </div>
                                    <div class="form-group has-success">
                                        <label for="cc-name" class="control-label mb-1">Mobile Number *</label>
                                        <input id="cc-name" name="mobile" type="text" class="form-control" value="{{ cmobile|safe }}" required>
                                    </div>
                                    <div class="form-group has-success">
                                        <label for="cc-name" class="control-label mb-1">Email Address *</label>
                                        <input id="cc-name" name="email" type="text" class="form-control" value="" required>
                                    </div>
                                    <div class="form-group has-success">
                                        <label for="cc-name" class="control-label mb-1">Address</label>
                                        <input id="cc-name" name="address" type="text" class="form-control" value="">
                                    </div>
                                    <div class="row">
                                        <div class="col-6">
                                            <div class="form-group">
                                                <label for="cc-exp" class="control-label mb-1">State</label>
                                                <input id="cc-exp" name="state" type="text" class="form-control" value="">
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <label for="x_card_code" class="control-label mb-1">City</label>
                                            <div class="input-group">
                                                <input id="x_card_code" name="city" type="text" class="form-control" value="">
                                            </div>
                                        </div>
                                        {% endif %}
                                        <div class="form-group has-success">
                                            <input id="promocode" name="promo" type="text" class="form-control" style="float:left;width:50%;"placeholder="Enter Promocode">
                                            <a class="btn btn-success" style="float:right;width:50%;cursor:pointer;" onclick="applypromo();" id="applypromobutton">Apply Promocode</a>
                                        </div>
                                        <div class="form-group has-success" style="width:100%;padding:14px;">
                                            <select onchange="document.getElementById('payment-button').disabled=false;acttransid();"data-placeholder="Select Payment Mode" class="standardSelect" tabindex="1" id="paymode" name="paymode">
                                                <option value=""></option>
                                                <option value="Cash">Pay By Cash</option>
                                                <option value="Card">Pay By Card</option>
                                                <option value="QR">Pay By QR Code</option>
                                            </select>
                                        </div>

                                        <div class="form-group has-success" style="display:none;" id="actpaymode">
                                            <label for="cc-name" class="control-label mb-1">Enter Transaction ID or Reciept Number</label>
                                            <input id="cc-name" name="transid" type="text" class="form-control" placeholder="Optional in case of Cash" onchange="">
                                        </div>

                                    </div>
                                    <div>
                                        <button disabled id="payment-button" type="submit" class="btn btn-lg btn-info btn-block">
                                        <i class="fa fa-lock fa-lg"></i>&nbsp;
                                        <span id="payment-button-amount">Pay <i class="fa fa-inr"></i>{{ taxamount|safe }}0</span>
                                        <span id="payment-button-sending" style="display:none;">Sendingâ€¦</span>
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>

                    </div>
                </div>
            </div><!-- .animated -->
        </div><!-- .content -->


    </div><!-- /#right-panel -->

    <!-- Right Panel -->


    <script src="{% static 'adminpages/vendors/jquery/dist/jquery.min.js' %}"></script>
    <script src="{% static 'adminpages/vendors/popper.js/dist/umd/popper.min.js' %}"></script>
    <script src="{% static 'adminpages/vendors/bootstrap/dist/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'adminpages/assets/js/main.js' %}"></script>


    <script src="{% static 'adminpages/vendors/datatables.net/js/jquery.dataTables.min.js' %}"></script>
    <script src="{% static 'adminpages/vendors/datatables.net-bs4/js/dataTables.bootstrap4.min.js' %}"></script>
    <script src="{% static 'adminpages/vendors/datatables.net-buttons/js/dataTables.buttons.min.js' %}"></script>
    <script src="{% static 'adminpages/vendors/datatables.net-buttons-bs4/js/buttons.bootstrap4.min.js' %}"></script>
    <script src="{% static 'adminpages/vendors/pdfmake/build/vfs_fonts.js' %}"></script>
    <script src="{% static 'adminpages/vendors/datatables.net-buttons/js/buttons.html5.min.js' %}"></script>
    <script src="{% static 'adminpages/vendors/datatables.net-buttons/js/buttons.print.min.js' %}"></script>
    <script src="{% static 'adminpages/vendors/datatables.net-buttons/js/buttons.colVis.min.js' %}"></script>
    <script src="{% static 'adminpages/assets/js/init-scripts/data-table/datatables-init.js' %}"></script>
<script src="{% static 'adminpages/vendors/chosen/chosen.jquery.min.js' %}"></script>
<script type="text/javascript">
    function acttransid(){
        var paymode = document.getElementById('paymode').value;
        if (paymode == 'Card' || paymode == 'QR'){
            document.getElementById('actpaymode').style.display = 'block';
        }
    }

    function applypromo(){
        var promo = document.getElementById('promocode').value;
        var amount = {{ taxamount|safe }};
        var url = 'http://127.0.0.1:8000/applypromocode/?amount=';
        var url = url.concat(amount);
        var finalurl = url.concat('&promo=');
        //alert();

        async function apply(finalurl){
            const response = await fetch(finalurl);
            var data = await response.json();
            document.getElementById('amounttopay').value = data.amount;
            var str = 'Pay ';
            document.getElementById('payment-button-amount').innerHTML = str.concat(data.amount);
            document.getElementById('applypromobutton').innerHTML = 'Applied!';
            //alert(data);
        }
        apply(finalurl.concat(promo));
    }
</script>
<script>
    jQuery(document).ready(function() {
        jQuery(".standardSelect").chosen({
            disable_search_threshold: 10,
            no_results_text: "Oops, nothing found!",
            width: "100%"
        });
    });
</script>
<script type="text/javascript">
    function searchcustomer(){
        document.getElementById('process').style.display = 'block';
        document.getElementById('customersearch').submit();
    }
</script>
</body>

</html>
